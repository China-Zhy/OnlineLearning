<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>基础表单</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
</head>
<body>

<div class="layui-form" lay-filter="layuiadmin-form-useradmin" id="layuiadmin-form-useradmin" style="padding: 20px 0 0 0;">
    <div class="layui-form-item">
        <label class="layui-form-label">活动图片</label>
        <div class="layui-input-inline">
            <input type="text" name="image" id="image" lay-verify="required" placeholder="请上传活动图片" autocomplete="off" class="layui-input" >
        </div>
        <button style="float: left;" type="button" class="layui-btn" id="layuiadmin-upload-useradmin">上传图片</button>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">活动标题</label>
        <div class="layui-input-inline">
            <input type="text" name="title" id="title" lay-verify="required" placeholder="请输入活动标题" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">开始时间</label>
        <div class="layui-input-inline">
            <input type="text" name="create" id="create" lay-verify="datetime|required" placeholder="请选择开始时间" autocomplete="off" class="layui-input">
        </div>

        <label class="layui-form-label">截止时间</label>
        <div class="layui-input-inline">
            <input type="text" name="deadline" id="deadline" lay-verify="datetime|required" placeholder="请选择截止时间" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">折扣力度</label>
        <div class="layui-input-inline">
            <input type="number" name="discount" id="discount" lay-verify="required" placeholder="请输入折扣力度" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">活动内容</label>
        <div class="layui-input-block" style="width: 500px">
            <textarea type="text" name="info" id="info" lay-verify="required" placeholder="请输入活动内容" class="layui-textarea"></textarea>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">创建用户</label>
        <div class="layui-input-inline">
            <input type="text" name="userId" id="userId" lay-verify="required" placeholder="请输入创建用户" autocomplete="off" class="layui-input">
        </div>
    </div>

    <!--这个用来存储ID，然后一起传到后端，用来修改信息，所以设为隐藏-->
    <input type="number" name="id" id="id" hidden="hidden">

    <div class="layui-form-item layui-hide">
        <input type="button" lay-submit lay-filter="LAY-user-front-submit" id="LAY-user-front-submit" value="确认">
    </div>
</div>

<script src="../../layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '../../layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form', 'upload', 'laydate'], function(){
        var $ = layui.$
            ,form = layui.form
            ,upload = layui.upload
            ,laydate = layui.laydate;

        // 表格顶部时间选择部分
        laydate.render({
            elem: '#create',
            type: 'datetime', // 设置日期时间选择器类型为 datetime
            format: 'yyyy-MM-dd HH:mm:ss' // 指定日期时间格式
        });

        laydate.render({
            elem: '#deadline',
            type: 'datetime', // 设置日期时间选择器类型为 datetime
            format: 'yyyy-MM-dd HH:mm:ss' // 指定日期时间格式
        });

        upload.render({
            elem: '#layuiadmin-upload-useradmin'
            ,url: layui.setter.base + 'json/upload/demo.js'
            ,accept: 'images'
            ,method: 'get'
            ,acceptMime: 'image/*'
            ,done: function(res){
                $(this.item).prev("div").children("input").val(res.data.src)
            }
        });

        // 使用Ajax异步加载数据信息(改这里)
        $(document).ready(function () {
            $.ajax({
                type: 'POST',
                url: '/active?method=getOneActive',
                data: {'id': $('#id').val()},
                dataType: 'json',
                success: function (data) {
                    let entity = data.data; // 获取后端传过来的实体信息
                    $('#image').val(entity.image);
                    $('#title').val(entity.title);
                    $('#create').val(entity.create);
                    $('#deadline').val(entity.deadline);
                    $('#discount').val(entity.discount);
                    $('#info').val(entity.info);
                    $('#userId').val(entity.userId);
                },
                error: function (xhr, status, error) {
                    layer.msg('Ajax请求失败啦', {offset: '15px', icon: 5, time: 1000});
                    console.log(error); // 控制台打印错误
                }
            });
        });
    })
</script>
</body>
</html>